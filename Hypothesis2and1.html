<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Hypothesis 2 &amp; 1</title>

<script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/7n4qj">
    <span class="fa fa-hand-spock-o"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Hypothesis 2 &amp; 1</h1>

</div>


<style>
body{
  font-family: 'Oxygen', sans-serif;
  font-size: 16px;
  line-height: 24px;
}
</style>
<p><span class="math display">\[\\[0.5in]\]</span></p>
<p>Here we compare genetic and phenotypic brain networks and investigate whether they have the same properties in terms of their association with age-volume correlations.</p>
<hr />
<p><br> <br></p>
<div id="hypothesis-2" class="section level1">
<h1>Hypothesis 2</h1>
<p>We hypothesise a positive association and high congruence between the two sets of factor loadings which would implicate that the same dimensions that underlie phenotypic variation in regional volumes also control the dimension of genetic sharing across these brain volumes. That is, it would suggest that phenotypic structural integrity recapitulates genetic integrity and that they are underpinned by similar general biological mechanisms.</p>
<p><br></p>
<div id="association-between-phenotypic-and-genetic-correlations" class="section level2">
<h2>Association between phenotypic and genetic correlations</h2>
<p>Previously, we have calculated a phenotypic and genetic correlation matrix between 83 brain areas. Here we test whether phenotypic correlations were equivalent to genetic correlations.</p>
<pre class="r"><code>##### correlate genetic and phenotypic correlations between brain regions
##### load genetic data
#set wd
workingd&lt;-getwd()
temporarywd&lt;-paste0(workingd,&quot;/data_my_own/ldsc/&quot;)
setwd(temporarywd)

load(&quot;whole_brain.RData&quot;)
ldscoutput&lt;-LDSCoutput_wholebrain

# name rows and columns
dimnames(ldscoutput$S_Stand)[[1]]&lt;-dimnames(ldscoutput$S)[[2]]
dimnames(ldscoutput$S_Stand)[[2]]&lt;-dimnames(ldscoutput$S)[[2]]

# keep lower matrix
cormatrix&lt;-ldscoutput$S_Stand
get_lower_tri&lt;-function(cormatrix){
  cormatrix[upper.tri(cormatrix)] &lt;- NA
  return(cormatrix)
}
genetic_cor&lt;-get_lower_tri(cormatrix)
genetic_cor&lt;-reshape2::melt(genetic_cor)
names(genetic_cor)&lt;-c(&quot;region1&quot;,&quot;region2&quot;,&quot;genetic_cor&quot;)

######## load phenotypic data

temporarywd_pheno&lt;-paste0(workingd,&quot;/data_my_own/Pheno_preparation/&quot;)
setwd(temporarywd_pheno)

load(&quot;pheno_decomposition.RData&quot;)

phenotypic_cor&lt;-cor_matrix

# sort same as genetic matrix
names&lt;-dimnames(ldscoutput$S)[[2]]
phenotypic_cor&lt;-phenotypic_cor[names,names]

# get lower triangle
phenotypic_cor&lt;-get_lower_tri(phenotypic_cor)
phenotypic_cor&lt;-reshape2::melt(phenotypic_cor)
names(phenotypic_cor)&lt;-c(&quot;region1&quot;,&quot;region2&quot;,&quot;phenotypic_cor&quot;)

gen_pheno&lt;-merge(genetic_cor,phenotypic_cor,by=c(&quot;region1&quot;,&quot;region2&quot;))



# remove correlations with itself (genetic and phenotypic)
gen_pheno$genetic_cor&lt;-ifelse(gen_pheno$region1 == gen_pheno$region2,NA,gen_pheno$genetic_cor)
gen_pheno$phenotypic_cor&lt;-ifelse(gen_pheno$region1 == gen_pheno$region2,NA,gen_pheno$phenotypic_cor)
# calculate correlation between phenotypic and genetic correlations
#cor.test(gen_pheno$genetic_cor,gen_pheno$phenotypic_cor)
cor_cor&lt;-round(cor(gen_pheno$genetic_cor,gen_pheno$phenotypic_cor,use=&quot;pairwise.complete.obs&quot;),digits=2)
#plot(gen_pheno$genetic_cor,gen_pheno$phenotypic_cor,ylab=&quot;Phenotypic correlations&quot;,xlab=&quot;Genetic correlations&quot;,xlim=c(-0.3,1),ylim=c(-0.3,1))
#abline(lm(gen_pheno$phenotypic_cor~gen_pheno$genetic_cor,na.action = &quot;na.omit&quot;),col=&quot;blue&quot;)
#abline(0,1,col=&quot;red&quot;)
#abline(x=0,col=&quot;green&quot;)

library(ggplot2)
library(ggpubr)

plot_corr&lt;-ggplot(gen_pheno, aes(x=genetic_cor,y=phenotypic_cor))+#
  geom_point(size=4,alpha=0.4)+
  geom_smooth(method=lm, se=TRUE) #+
  #ggtitle(&quot;Phenotypic vs. genetic correlations&quot;)
  
plot_corr&lt;- plot_corr+xlab(&quot;Genetic correlations&quot;)+ ylab(&quot;Phenotypic correlations&quot;)+
  theme(plot.title = element_text(size=20, hjust = 0.5), panel.background = element_blank(), axis.line = element_line(color=&quot;black&quot;), axis.line.x = element_line(color=&quot;black&quot;))+ theme_bw()+
    stat_cor(method=&quot;pearson&quot;,cor.coef.name=&quot;r&quot;,size=4.5,position = &quot;identity&quot;,)+
  theme(legend.position = &quot;none&quot;)+
    geom_abline(intercept=0,slope=(1),linetype=&quot;dashed&quot;,color=&quot;red&quot;,show.legend=T, size=1,alpha=0.7)+
    geom_vline(xintercept = 0,linetype=&quot;dashed&quot;,color=&quot;black&quot;,size=1.5,alpha=0.2)+
    theme(text = element_text(size=12,family=&quot;Arial Narrow&quot;),
        axis.text.x = element_text(size=15,family=&quot;Arial Narrow&quot;),#angle=45
        axis.text.y = element_text(size=15,family=&quot;Arial Narrow&quot;),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17,family=&quot;Arial Narrow&quot;),
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17,family=&quot;Arial Narrow&quot;))
plot_corr</code></pre>
<p><img src="Hypothesis2and1_files/figure-html/pheno_vs_geno-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>summary(lm(gen_pheno$phenotypic_cor~gen_pheno$genetic_cor,na.action = &quot;na.omit&quot;))</code></pre>
<pre><code>## 
## Call:
## lm(formula = gen_pheno$phenotypic_cor ~ gen_pheno$genetic_cor, 
##     na.action = &quot;na.omit&quot;)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.34100 -0.04031  0.00022  0.04062  0.25199 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.065770   0.002713   24.25   &lt;2e-16 ***
## gen_pheno$genetic_cor 0.598096   0.006674   89.61   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.06172 on 3401 degrees of freedom
##   (3486 observations deleted due to missingness)
## Multiple R-squared:  0.7025, Adjusted R-squared:  0.7024 
## F-statistic:  8031 on 1 and 3401 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><strong>The red line is the line of identity.</strong></p>
<p>We correlated phenotypic with genetic correlations among these areas, and we obtained a significant correlation of 0.84. This indicates that phenotypic correlations predict genetic correlations fairly well.</p>
<p><br/> <br/></p>
<pre class="r"><code>temporarywd&lt;-paste0(workingd,&quot;/data_my_own/ldsc/&quot;)
setwd(temporarywd)

load(&quot;whole_brain.RData&quot;)
ldscoutput&lt;-LDSCoutput_wholebrain
  dimnames(ldscoutput$S_Stand)[[1]]&lt;-dimnames(ldscoutput$S)[[2]]
  dimnames(ldscoutput$S_Stand)[[2]]&lt;-dimnames(ldscoutput$S)[[2]]

k&lt;-nrow(ldscoutput$S)
SE&lt;-matrix(0, k, k)
SE[lower.tri(SE,diag=TRUE)] &lt;-sqrt(diag(ldscoutput$V))

get_lower_tri&lt;-function(cormatrix){
  cormatrix[upper.tri(cormatrix)] &lt;- NA
  return(cormatrix)
}

SE_lower&lt;-get_lower_tri(SE)
SE_lower&lt;-reshape2::melt(SE_lower)</code></pre>
<hr />
<p><br></p>
</div>
<div id="association-between-phenotypic-and-genetic-loadings-on-the-first-pc" class="section level2">
<h2>Association between phenotypic and genetic loadings on the first PC</h2>
<pre class="r"><code># load phenotypic loadings
temporarywd_pheno&lt;-paste0(workingd,&quot;/data_my_own/Pheno_preparation/&quot;)
setwd(temporarywd_pheno)

load(&quot;pheno_decomposition.RData&quot;)

pheno_stand_loadings&lt;-stand_loadings
names(pheno_stand_loadings)[2]&lt;-&quot;pheno_stand_loadings&quot;
pheno_stand_loadings$pheno_stand_loadings&lt;-pheno_stand_loadings$pheno_stand_loadings*(-1)

# load genetic loadings
library(data.table)

temporarywd&lt;-paste0(workingd,&quot;/data_my_own/standardised_loadings/&quot;)
setwd(temporarywd)

gen_stand_loadings&lt;-read.table(&quot;stand_loadings_whole_brain.txt&quot;,header=T)
names(gen_stand_loadings)[2]&lt;-&quot;gen_stand_loadings&quot;

    # multiply the loadings with -1 if the median of the loadings is negative
    median_loadings&lt;-median(gen_stand_loadings$gen_stand_loadings)
    mean_direction&lt;-sign(median_loadings)
    if(mean_direction == -1){
    gen_stand_loadings$gen_stand_loadings&lt;-gen_stand_loadings$gen_stand_loadings*(-1)
    } else {
    gen_stand_loadings$gen_stand_loadings&lt;-gen_stand_loadings$gen_stand_loadings}
    
    
stand_loadings&lt;-merge(pheno_stand_loadings,gen_stand_loadings,by=&quot;Regions&quot;)

#calculate correlation between loadings
summary(lm(stand_loadings$pheno_stand_loadings~stand_loadings$gen_stand_loadings,na.action = &quot;na.omit&quot;))</code></pre>
<pre><code>## 
## Call:
## lm(formula = stand_loadings$pheno_stand_loadings ~ stand_loadings$gen_stand_loadings, 
##     na.action = &quot;na.omit&quot;)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.181192 -0.043779  0.000451  0.056009  0.132253 
## 
## Coefficients:
##                                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                        0.14693    0.03830   3.836 0.000246 ***
## stand_loadings$gen_stand_loadings  0.64624    0.06081  10.626  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.07121 on 81 degrees of freedom
## Multiple R-squared:  0.5823, Adjusted R-squared:  0.5771 
## F-statistic: 112.9 on 1 and 81 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code># save statistics in objects for text
model&lt;-lm(stand_loadings$pheno_stand_loadings~stand_loadings$gen_stand_loadings,na.action = &quot;na.omit&quot;)
beta&lt;-round(summary(model)$coefficient[2,1],digits = 2)
SE&lt;-round(summary(model)$coefficient[2,2],digits = 2)
pval&lt;-signif(summary(model)$coefficient[2,4],digits =3)


## calculate absolute mean difference between phenotypic and genetic PC loadings
#delta_cor&lt;-abs(stand_loadings$pheno_stand_loadings-stand_loadings$gen_stand_loadings)
#mean(delta_cor,na.rm=T)
#sd(delta_cor,na.rm=T)</code></pre>
<p>Genetic loadings significantly predict phenotypic loadings (<em>b</em> = 0.65, <em>SE</em> = 0.06, <em>pvalue</em> = 5.07^{-17}).</p>
<pre class="r"><code>library(ggplot2)
library(ggpubr)

# read in area names of central executive areas
central_areas&lt;-fread(paste0(workingd,&quot;/Scripts/my_own_gwas/2Perform_ldsc/central_executive_areas.txt&quot;),header=F,data.table=F)
central_areas&lt;-as.vector(central_areas[,1])

# create vector encoding which areas are part of central executive network
stand_loadings$central_exec&lt;-FALSE

for(i in central_areas){
  stand_loadings$central_exec[which(stand_loadings$Regions==i)]&lt;-TRUE
}

# chose which colors to assign to central executive areas
stand_loadings$central_col&lt;-ifelse(stand_loadings$central_exec==1,&quot;red&quot;,&quot;darkblue&quot;)


plot_loadings&lt;-ggplot(stand_loadings, aes(x=gen_stand_loadings,y=pheno_stand_loadings))+#
                        geom_point(size=4,alpha=0.4,color=stand_loadings$central_col)+
                        geom_smooth(method=lm, se=TRUE) #+
                        #ggtitle(&quot;Phenotypic vs. genetic PC loadings&quot;)
  
  plot_loadings&lt;-plot_loadings+
                xlab(&quot;Genetic PC loadings&quot;)+
                ylab(&quot;Phenotypic PC loadings&quot;)+
                theme(
                  plot.title = element_text(size=20, hjust = 0.5), 
                  panel.background = element_blank(), 
                  axis.line = element_line(color=&quot;black&quot;), 
                  axis.line.x = element_line(color=&quot;black&quot;))+ 
    theme_bw()+
    stat_cor(method=&quot;pearson&quot;,cor.coef.name=&quot;r&quot;,size=4.5,label.x.npc=0.65,label.y.npc = 0)+
    theme(legend.position = &quot;none&quot;)+
    geom_abline(intercept=0,
                slope=(1),
                linetype=&quot;dashed&quot;,
                color=&quot;red&quot;,
                show.legend=T, 
                size=1.5,
                alpha=0.6)+
        theme(text = element_text(size=12),
              axis.text.x = element_text(size=15),
              axis.text.y = element_text(size=15),
              axis.title.y = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17),
              axis.title.x = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17))
plot_loadings</code></pre>
<p><img src="Hypothesis2and1_files/figure-html/plot_loadings-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>The red line is the line of identity. PC loadings marked in red belong to regions that are part of the central executive network.</strong></p>
<hr />
<p><br></p>
</div>
<div id="tucker-congruence-coefficient" class="section level2">
<h2>Tucker congruence coefficient</h2>
<div id="tucker-coefficient-whole-brain" class="section level3">
<h3>Tucker coefficient: Whole brain</h3>
<pre class="r"><code># to calculate factor congruence, insert covariance matrix
# cor_matrix saved in pheno_decomposition.RData is phenotypic cov matrix
# https://openpsych.net/forum/attachment.php?aid=364
# cut off for Tucker index to assume similarity range from .85-.94
library(psych)
pheno_eigenvector&lt;-principal(cor_matrix)
match_names&lt;-dimnames(cor_matrix)[[1]]

# genetic matrix inferred through LDSC 
temporarywd&lt;-paste0(workingd,&quot;/data_my_own/ldsc/&quot;)
setwd(temporarywd)

load(&quot;whole_brain.RData&quot;)
genetic_whole_brain_matrix&lt;-LDSCoutput_wholebrain$S_Stand
colnames(genetic_whole_brain_matrix)&lt;-dimnames(LDSCoutput_wholebrain$S)[[2]]
rownames(genetic_whole_brain_matrix)&lt;-dimnames(LDSCoutput_wholebrain$S)[[2]]
genetic_whole_brain_matrix&lt;-genetic_whole_brain_matrix[match_names,match_names]
gen_eigenvector&lt;-principal(genetic_whole_brain_matrix)


tucker_index&lt;-factor.congruence(x=pheno_eigenvector,y=gen_eigenvector)
# smoothing required because the last PC has negative eigenvalues</code></pre>
<p>The Tucker congruence coefficient for the loadings of the first PC in phenotypic vs. genetic correlation matrices is <strong>0.99</strong>. It has been previously suggested that an index between .85-.94 indicates a “fair similarity” between the loadings (Lorenzo-Seva &amp; ten Berge, 2006, <em>Methodology</em>, doi: 10.1027/1614-1881.2.2.57).</p>
</div>
<div id="tucker-coefficient-a-priori-networks" class="section level3">
<h3>Tucker coefficient: A priori networks</h3>
<pre class="r"><code># read in genetic corr matrix
temporarywd&lt;-paste0(workingd,&quot;/data_my_own/ldsc/&quot;)
setwd(temporarywd)

load(&quot;whole_brain.RData&quot;)
genetic_whole_brain_matrix&lt;-LDSCoutput_wholebrain$S_Stand
colnames(genetic_whole_brain_matrix)&lt;-dimnames(LDSCoutput_wholebrain$S)[[2]]
rownames(genetic_whole_brain_matrix)&lt;-dimnames(LDSCoutput_wholebrain$S)[[2]]

# set wd to where region names per network are saved
temporarywd&lt;-paste0(workingd,&quot;/Scripts/my_own_gwas/2Perform_ldsc/&quot;)
setwd(temporarywd)

# load files containing region names
central_exec_regions&lt;-read.table(&quot;central_executive_areas.txt&quot;)$V1
cingulo_regions&lt;-read.table(&quot;cingulo_opercular_areas.txt&quot;)$V1
default_regions&lt;-read.table(&quot;default_mode_areas.txt&quot;)$V1
hippocampal_regions&lt;-read.table(&quot;hippocampal_diencephalic_areas.txt&quot;)$V1
multiple_demand_regions&lt;-read.table(&quot;multiple_demand_areas.txt&quot;)$V1
p_fit_regions&lt;-read.table(&quot;p_fit_areas.txt&quot;)$V1
salience_regions&lt;-read.table(&quot;salience_areas.txt&quot;)$V1
sensori_regions&lt;-read.table(&quot;sensorimotor_areas.txt&quot;)$V1
temporo_regions&lt;-read.table(&quot;temporo_amygdala_orbitofrontal_areas.txt&quot;)$V1


library(psych)
library(stringr)
network_regions&lt;-ls(pattern=&quot;_regions&quot;)

# create df to display Tucker-Lewis index per network
display_Tucker&lt;-data.frame(matrix(ncol=2))
colnames(display_Tucker)&lt;-c(&quot;network&quot;,&quot;Tucker_index&quot;)

for(i in network_regions){
  regions&lt;-get(i)
  #print(i)
  
  # decomposition pheno
  pheno&lt;-principal(cor_matrix[regions,regions])

  # decomposition geno
  geno&lt;-principal(genetic_whole_brain_matrix[regions,regions])
  
  # calculate Tucker-Lewis index
  tucker_lewis_index&lt;-factor.congruence(x=pheno,y=geno)
  
  # save index
  network_name&lt;-str_remove(i,pattern=&quot;_regions&quot;)
  #assign(network_name,tucker_lewis_index)
  
  # save index in table
  display_Tucker[which(network_regions ==i),&quot;network&quot;]&lt;-network_name
  display_Tucker[which(network_regions ==i),&quot;Tucker_index&quot;]&lt;-tucker_lewis_index
}

kable(display_Tucker, label=&quot;Tucker-Lewis Index indicating factor congruence between phenotypic and genetic networks&quot;, col.names = c(&quot;Networks&quot;,&quot;Tucker congruence coefficient&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Networks</th>
<th align="right">Tucker congruence coefficient</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">central_exec</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">cingulo</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">default</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td align="left">hippocampal</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">multiple_demand</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">p_fit</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">salience</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td align="left">sensori</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">temporo</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
<hr />
<p><br></p>
</div>
</div>
</div>
<div id="hypothesis-1" class="section level1">
<h1>Hypothesis 1</h1>
<p>We hypothesise a negative correlation between genetic brain-wide PC loadings and phenotypically derived age sensitivities. We do not make a prediction about the size of the correlation as no previous study known to us has investigated this question on a genetic level. A significant association would indicate that the same general dimensions of variation in global brain aging underlie the dimension of genetic sharing across brain regions.</p>
<div id="association-between-phenotypic-pc-loadings-and-age-volume-correlations" class="section level2">
<h2>Association between phenotypic PC loadings and age-volume correlations</h2>
<pre class="r"><code># load phenotypic loadings
names(age_cor)[2]&lt;-&quot;Regions&quot;
phenotest&lt;-merge(stand_loadings,age_cor,by=&quot;Regions&quot;)

plot_age_pheno&lt;-ggplot(phenotest, aes(x=pheno_stand_loadings,y=age_cor))+#
  geom_point(size=4,alpha=0.4,color=phenotest$central_col)+
  geom_smooth(method=lm, se=TRUE)#,color=&quot;blue&quot;) #+
  #ggtitle(&quot;Phenotypic age correlations vs. phenotypic PC loadings&quot;)
  
  plot_age_pheno&lt;-
    plot_age_pheno+
    xlab(&quot;Phenotypic PC loadings&quot;)+
    ylab(&quot;Age correlations&quot;)+
    theme(plot.title = element_text(size=20, hjust = 0.5), 
          panel.background = element_blank(), 
          axis.line = element_line(color=&quot;black&quot;), 
          axis.line.x = element_line(color=&quot;black&quot;))+ 
    theme_bw()+
    stat_cor(method=&quot;pearson&quot;,
             cor.coef.name=&quot;r&quot;,
             size=4.5,
             color=&quot;black&quot;,
             label.x.npc=0.65,
             label.y.npc = 0)+
  theme(legend.position = &quot;none&quot;)+
        theme(text = element_text(size=12),
        axis.text.x = element_text(size=15),#angle=45
        axis.text.y = element_text(size=15),
        axis.title.y = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17),
        axis.title.x = element_text(face=&quot;bold&quot;, colour=&#39;black&#39;, size=17))

plot_age_pheno</code></pre>
<p><img src="Hypothesis2and1_files/figure-html/corr_phenotypes-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>PC loadings marked in red belong to regions that are part of the central executive network.</strong></p>
<p><br> <br></p>
</div>
<div id="association-between-genetic-pc-loadings-and-age-volume-correlations" class="section level2">
<h2>Association between genetic PC loadings and age-volume correlations</h2>
<pre class="r"><code># merge age  correlations with standardised loadings
names(age_cor)[2]&lt;-&quot;Regions&quot;
data&lt;-merge(stand_loadings,age_cor,by=&quot;Regions&quot;)

# correlate genetic stand loadings with age cor
age_correlation_result&lt;-cor.test(data$gen_stand_loadings,data$age_cor)
age_cor_estimate&lt;-round(age_correlation_result$estimate,digits = 2)
age_cor_pval&lt;-round(age_correlation_result$p.value,digits = 3)</code></pre>
<p>Genetic loadings are significantly correlated with age sensitivity (<em>r</em> = -0.27, <em>p-value</em> = 0.012).</p>
<p><img src="Hypothesis2and1_files/figure-html/lot_age_cor-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>PC loadings marked in red belong to regions that are part of the central executive network.</strong></p>
<p><br> <br></p>
<div id="plot-all-four-correlation-plots" class="section level3">
<h3>Plot all four correlation plots</h3>
<pre class="r"><code>library(cowplot)

tiff(&quot;corr.tiff&quot;, width = 15, height = 10, units = &#39;in&#39;, res=1000)

plot_grid(plot_corr,plot_loadings,plot_age_pheno,plot_age_geno,nrow = 2,ncol = 2,labels=c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;),width=1,height=1, label_size = 18,hjust = 0.07,scale = 0.85)

dev.off()</code></pre>
</div>
</div>
</div>

&nbsp;
<hr />
<a href = "https://www.kcl.ac.uk/">
<p style="text-align: center"><img src="KCL_logo.jpg" href="https://www.kcl.ac.uk/" style="width:70px;height:50px"> 
</a>
</p>

<a href = "https://www.kcl.ac.uk/people/anna-furtjes">
<p style="text-align: center;">By Anna Elisabeth Fürtjes</a></p>
<p style="text-align: center;"><span style="color: #808080;"><em>anna.furtjes@kcl.ac.uk</em></span></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://twitter.com/Anna_Furtjes" class="fa fa-twitter"></a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
